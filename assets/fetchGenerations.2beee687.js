import{k as i,d as k,o as x,g as B,e as y,n as N,_ as A,B as D,c as L,f as S,q as $}from"./index.56f7abcc.js";const T="pokedev",C=1;let p;const P=window.indexedDB;var h=(e=>(e.API_CALLS="api_calls",e))(h||{});async function I(){return new Promise((e,n)=>{if(p)return e(p);const o=P.open(T,C);o.onerror=a=>n(a),o.onsuccess=a=>{var t;p=(t=a.target)==null?void 0:t.result,e(p)},o.onupgradeneeded=a=>{var s;const t=(s=a.target)==null?void 0:s.result;a.oldVersion<1&&t.createObjectStore("api_calls",{keyPath:"url"})}})}async function b(e,n){if(!e)return null;const o=await I();return new Promise(a=>{const c=o.transaction([n],"readwrite").objectStore(n).get(e);c.onsuccess=()=>{var r;a((r=c.result)==null?void 0:r.data)}})}async function F(e,n){const o=await I();return new Promise((a,t)=>{try{const s=o.transaction([n],"readwrite");s.oncomplete=()=>a(!0),s.onerror=r=>t(r),s.onabort=r=>t(r),s.objectStore(n).put(e)}catch(s){t(s)}})}async function v(e){const n=i(!0),o=i(),a=i(),t=e.includes("https")?e:`${"https://pokeapi.co/api/v2/"+e}`;if(a.value=await b(t,h.API_CALLS),!a.value){const s=await fetch(t).then(c=>c.json());a.value=s,await F({url:t,data:s},h.API_CALLS)}return n.value=!1,{isLoading:n,error:o,data:a}}async function R(e,n=!1){const o=i(),a=i(!1);a.value=!0;const{data:t}=await v(`pokemon/${e}`);if(o.value=t.value,n&&t.value){const{data:s}=await v(`pokemon-species/${t.value.species.name}`);o.value={...s.value,...o.value}}return a.value=!1,{pokemon:o,isLoading:a}}const W=e=>e.replace(/(?:^|\s|-)\S/g,n=>n.toUpperCase()),E=(e,n="es",o=!1)=>{var a;return((a=e==null?void 0:e.find(t=>t.language.name===n))==null?void 0:a.name)||(o?"":E(e,"en",!0))},U=(e,n="es",o=!1)=>{var a;return((a=e==null?void 0:e.find(t=>t.language.name===n))==null?void 0:a.flavor_text)||(o?"":U(e,"en",!0))},M=(e,n="es",o=!1)=>{var a;return((a=e==null?void 0:e.find(t=>t.language.name===n))==null?void 0:a.genus)||(o?"":M(e,"en",!0))},V=["src"],q=k({__name:"IconType",props:{pokemonType:null},setup(e){return(n,o)=>(x(),B("div",{class:N("type-"+e.pokemonType)},[y("img",{src:`icons/types/${e.pokemonType}.svg`,alt:""},null,8,V)],2))}});const j=A(q,[["__scopeId","data-v-9d8f42a7"]]);function z(){const e=i([]);function n(t,s){var l,u,d,m;if(!(t!=null&&t.target)||!s)return;if((s.name.split("-")[1]||s.name)==="gmax"){const g=`https://play.pokemonshowdown.com/sprites/gen5/${s.name}.png`;if(!e.value.includes(g)){t.target.src=g,e.value.push(g);return}}const r=`https://play.pokemonshowdown.com/sprites/ani/${(u=(l=s==null?void 0:s.species)==null?void 0:l.name)==null?void 0:u.replaceAll("-","")}.gif`;if(!e.value.includes(r)){t.target.src=r,e.value.push(r);return}const f=`https://play.pokemonshowdown.com/sprites/gen5/${(d=s==null?void 0:s.species)==null?void 0:d.name}.png`;if(!e.value.includes(f)){t.target.src=f,e.value.push(f);return}(m=t.target.parentNode)==null||m.removeChild(t.target)}function o(t,s){var r;const c=`https://play.pokemonshowdown.com/sprites/ani/${s.replaceAll("-","")}.gif`;if(!e.value.includes(c)){t.target.src=c,e.value.push(c);return}(r=t.target.parentNode)==null||r.removeChild(t.target)}function a(){e.value=[]}return{clearTriesList:a,replaceWithDefaultSprite:n,replaceUsingName:o}}const G=["src","alt"],H=k({__name:"PokemonImage",props:{pokemon:null,imageName:null,notAnimated:{type:Boolean},type:null},setup(e){var r,f;const n=e,{replaceWithDefaultSprite:o,clearTriesList:a}=z();D(()=>a());const t=i(`https://play.pokemonshowdown.com/sprites/ani/${n.imageName||((f=(r=n.pokemon)==null?void 0:r.species)==null?void 0:f.name)}.gif`),s=L(()=>{var u,d,m,g,_,w;let l;switch(n.type){case"artwork":l=(g=(m=(d=(u=n.pokemon)==null?void 0:u.sprites)==null?void 0:d.other)==null?void 0:m["official-artwork"])==null?void 0:g.front_default;break;default:l=(w=(_=n.pokemon)==null?void 0:_.sprites)==null?void 0:w.front_default}return l||t.value}),c=i(n.notAnimated?s:t.value);return(l,u)=>{var d;return e.pokemon?(x(),B("img",{key:0,loading:"lazy",src:c.value,alt:"Sprite de "+((d=e.pokemon.species)==null?void 0:d.name),onError:u[0]||(u[0]=m=>S(o)(m,e.pokemon))},null,40,G)):$("",!0)}}});function J(){const e=i([]);return v("generation").then(({data:n})=>{n.value.results.forEach(({url:o})=>{v(o).then(a=>{const{data:t}=a;t.value&&e.value.push(t.value)})})}),{generations:e}}export{j as I,H as _,v as a,R as b,W as c,U as d,z as e,M as f,E as t,J as u};
